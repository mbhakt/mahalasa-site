<!--
Shri Mahalasa Daily Darshan - One Page Template (Modernized Layout + Styled Subscribe Button)

Changes:
- Modern, clean layout with glassmorphism card, larger hero image area, and responsive two-column layout.
- Subscribe button styled with rounded corners, golden gradient, subtle glow, and touch-friendly sizing.
- Improved spacing, typography (Google Font) and accessibility attributes.

How to use:
- This file is visual only; all existing IDs (darshanImg, subscribeForm, etc.) remain so existing scripts will still work.
- Replace images and audio assets as before.
-->

<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="#f8f1e6">

  <title>श्री महालसा — Daily Darshan & Mantra</title>
  <meta name="description" content="Daily darshan of Shri Mahalasa, mantra of the day, aarti, and devotional wallpapers. Updated daily — beautiful temple-style design." />

  <!-- Fonts & Tailwind -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{--gold-1:#f6d365;--gold-2:#fda085;--glass-bg:rgba(255,255,255,0.72);} 
    body { font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Noto Sans Devanagari', 'Noto Sans', sans-serif; }
    .title-font{ font-family: 'Playfair Display', serif; }
    .gold-gradient { background: linear-gradient(90deg,var(--gold-1),var(--gold-2)); }
    .card-glass{ background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.60)); backdrop-filter: blur(6px); }
    /* gentle golden glow for CTA */
    .cta-glow{ box-shadow: 0 6px 25px rgba(253,160,133,0.18), 0 1px 0 rgba(255,255,255,0.6) inset; }
  </style>
</head>
<body class="bg-gradient-to-b from-amber-50 via-white to-amber-50 min-h-screen text-gray-800">
  <header class="max-w-6xl mx-auto px-6 py-6 flex items-center justify-between">
    <div class="flex items-center gap-4">
      <div class="w-12 h-12 rounded-full gold-gradient flex items-center justify-center shadow-md">
        <span class="title-font text-white text-lg">श्री</span>
      </div>
      <div>
        <h1 class="title-font text-2xl md:text-3xl font-bold leading-tight">श्री महालसा</h1>
        <p class="text-sm text-gray-600">Daily Darshan • Mantra • Aarti</p>
      </div>
    </div>
    <nav class="hidden md:flex gap-4 text-sm text-gray-700">
      <a href="#darshan" class="hover:underline">Darshan</a>
      <a href="#mantra" class="hover:underline">Mantra</a>
      <a href="#download" class="hover:underline">Wallpapers</a>
    </nav>
  </header>

  <main class="max-w-6xl mx-auto px-6 pb-12">
    <section id="darshan" class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-start">

      <!-- Left: large hero card -->
      <div class="lg:col-span-2">
        <div class="rounded-2xl overflow-hidden shadow-xl">
          <div class="relative bg-gray-100">
            <img id="darshanImg" src="/assets/images/placeholder.jpg" alt="Shri Mahalasa Darshan" class="w-full h-96 md:h-[480px] object-cover transition-transform duration-700 ease-out scale-100 hover:scale-105" />
            <div class="absolute left-6 bottom-6 bg-black/30 text-white px-4 py-2 rounded-lg backdrop-blur"> 
              <span id="imageDate" class="text-sm font-medium">—</span>
            </div>
            <div class="absolute right-6 bottom-6 flex gap-3">
              <button id="downloadBtn" class="px-4 py-2 rounded-full bg-white/90 text-amber-700 font-semibold shadow-sm hover:scale-105 transition">Download</button>
              <button id="shareBtn" class="px-4 py-2 rounded-full bg-white/70 text-gray-800 font-medium shadow-sm hover:scale-105 transition">Share</button>
            </div>
          </div>

          <div class="p-6 card-glass">
            <h2 class="text-xl font-semibold">Daily Message</h2>
            <p class="mt-2 text-gray-700">Visit daily for a fresh darshan, mantra, and aarti. Share with family and friends to spread devotion.</p>
            <div class="mt-4 flex flex-wrap gap-3">
              <button id="nextBtn" class="px-4 py-2 rounded-md border border-amber-200 text-amber-700 font-medium">Next Image</button>
              <!-- placeholder for small ad or sponsor -->
              <div class="ml-auto text-sm text-gray-500">Ad space</div>
            </div>
          </div>
        </div>

        <!-- Mantra player card -->
        <div id="mantra" class="mt-6 rounded-xl p-4 card-glass shadow-sm flex items-center gap-4">
          <div class="flex-1">
            <h3 class="text-lg font-semibold">Mantra of the Day</h3>
            <p id="mantraText" class="mt-2 text-gray-800">ॐ स्फटिकाय नमः — (example mantra)</p>
          </div>
          <div class="flex items-center gap-3">
            <audio id="mantraAudio" controls preload="none" class="w-64 md:w-96">
              <source id="audioSource" src="/assets/audio/sample-mantra.mp3" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio>
            <button id="repeatBtn" class="px-3 py-2 border rounded-md text-gray-700">Repeat: Off</button>
          </div>
        </div>
      </div>

      <!-- Right: Today panel + subscribe -->
      <aside class="lg:col-span-1">
        <div class="sticky top-6 space-y-4">
          <div class="p-4 rounded-xl card-glass shadow-sm">
            <h4 class="font-semibold">Today</h4>
            <p id="todayTithi" class="text-sm text-gray-600 mt-2">Tithi : शुक्ल त्रयोदशी (example)</p>
            <p id="todayNakshatra" class="text-sm text-gray-600 mt-1">Nakshatra : रोहिणी</p>
          </div>

          <div class="p-4 rounded-xl card-glass shadow-sm">
            <label class="text-sm text-gray-700 font-medium">Subscribe for daily darshan</label>
            <form id="subscribeForm" action="#" method="POST" class="mt-3 flex items-center gap-3">
              <input name="email" type="email" placeholder="Your email" required aria-label="Email address" class="flex-1 px-3 py-2 rounded-md border border-gray-200 focus:outline-none focus:ring-2 focus:ring-amber-200" />
              <button type="submit" class="px-4 py-2 rounded-full title-font text-white font-semibold cta-glow gold-gradient hover:opacity-95 transition-shadow">Subscribe</button>
            </form>
            <p class="text-xs text-gray-500 mt-2">We respect your privacy. Unsubscribe anytime.</p>
          </div>

          <div class="p-4 rounded-xl card-glass shadow-sm text-sm text-gray-600">
            <div class="font-semibold mb-2">Wallpapers</div>
            <div id="thumbGrid" class="grid grid-cols-3 gap-2"> <!-- thumbnails filled by JS --> </div>
          </div>
        </div>
      </aside>

    </section>

    <footer class="mt-12 text-center text-sm text-gray-600">Made with devotion ❤️ — © <span id="year"></span> Shri Mahalasa Digital Temple</footer>
  </main>

  <!-- Keep IDs and structure so existing scripts still work -->
  <!-- Content-loading script: fetch content.json and initialize the page -->
  <script>
    // ===== CONFIG =====
    // Replace this with your RAW GitHub URL (keep the quotes)
    const CONTENT_JSON_URL = "https://raw.githubusercontent.com/mbhakt/mahalasa-site/refs/heads/main/content.json"; // e.g. "https://raw.githubusercontent.com/username/repo/main/content.json"

    // Fallback content if fetch fails
    const fallbackContent = {
      date: (new Date()).toISOString().slice(0,10),
      tithi: 'शुक्ल त्रयोदशी (example)',
      nakshatra: 'रोहिणी (example)',
      mantra: 'ॐ जय महालसा महालक्ष्मी नमः',
      mantraAudio: '/assets/audio/mantra1.mp3',
      images: [
        { src: '/assets/images/mahalasa1.jpg', title: 'Mahalasa - Morning Darshan' },
        { src: '/assets/images/mahalasa2.jpg', title: 'Mahalasa - Temple Frame' },
        { src: '/assets/images/mahalasa3.jpg', title: 'Mahalasa - Aarti Evening' }
      ]
    };

    // small helpers
    const safeText = s => (typeof s === 'string') ? s : '';
    function formatDate(d){ return d.toLocaleDateString('hi-IN', { day:'numeric', month:'long', year:'numeric' }); }

    // Fetch content.json (if URL provided) and return a content object
    async function fetchContentJson(){
      if(!CONTENT_JSON_URL) return fallbackContent;
      try{
        const res = await fetch(CONTENT_JSON_URL, { cache: 'no-store' });
        if(!res.ok) { console.warn('Failed to fetch content.json', res.status); return fallbackContent; }
        const json = await res.json();
        if(json && Array.isArray(json.images) && json.mantra) return json;
        console.warn('content.json missing required fields — using fallback');
        return fallbackContent;
      }catch(err){
        console.warn('Error fetching content.json — using fallback', err);
        return fallbackContent;
      }
    }

    // Initialize DOM with provided content
    function initPageWithContent(content){
      const images = Array.isArray(content.images) && content.images.length ? content.images : fallbackContent.images;
      const today = content.date ? new Date(content.date) : new Date();

      // Elements (guarded)
      const imgEl = document.getElementById('darshanImg');
      const dateEl = document.getElementById('imageDate');
      const downloadBtn = document.getElementById('downloadBtn');
      const shareBtn = document.getElementById('shareBtn');
      const nextBtn = document.getElementById('nextBtn');
      const mantraTextEl = document.getElementById('mantraText');
      const mantraAudio = document.getElementById('mantraAudio');
      const audioSource = document.getElementById('audioSource');
      const repeatBtn = document.getElementById('repeatBtn');
      const thumbGrid = document.getElementById('thumbGrid');
      const yearEl = document.getElementById('year');
      const subsForm = document.getElementById('subscribeForm');

      if(yearEl) yearEl.textContent = today.getFullYear();
      const tithiEl = document.getElementById('todayTithi'); if(tithiEl) tithiEl.textContent = 'Tithi: ' + safeText(content.tithi);
      const nakEl = document.getElementById('todayNakshatra'); if(nakEl) nakEl.textContent = 'Nakshatra: ' + safeText(content.nakshatra);

      // Choose image by date
      const idx = Math.abs(Math.floor(today.getTime()/86400000)) % images.length;
      const current = images[idx] || images[0];
      if(imgEl){ imgEl.src = current.src; imgEl.alt = current.title || 'Shri Mahalasa Darshan'; }
      if(dateEl){ dateEl.textContent = content.date ? new Date(content.date).toLocaleDateString('hi-IN', { day:'numeric', month:'long', year:'numeric' }) : formatDate(new Date()); }

      // Mantra/audio
      if(mantraTextEl) mantraTextEl.textContent = safeText(content.mantra || fallbackContent.mantra);
      if(audioSource && mantraAudio) { audioSource.src = safeText(content.mantraAudio || fallbackContent.mantraAudio); mantraAudio.load(); }

      // download handler
      if(downloadBtn && imgEl){ downloadBtn.addEventListener('click', ()=>{ try{ const link=document.createElement('a'); link.href=imgEl.src; link.download='mahalasa-'+(new Date()).toISOString().slice(0,10)+'.jpg'; document.body.appendChild(link); link.click(); link.remove(); }catch(e){ console.warn(e); } }); }

      // share handler (Web Share API with fallbacks)
      if(shareBtn){
        shareBtn.addEventListener('click', async ()=>{
          const shareData = { title: 'श्री महालसा — Daily Darshan', text: "Today's darshan of Shri Mahalasa", url: window.location.href };
          if(navigator.share){ try{ await navigator.share(shareData); }catch(e){ console.log('share failed', e); } }
          else {
            try{ await navigator.clipboard.writeText(window.location.href); alert('Link copied to clipboard. Share it on WhatsApp or Facebook.'); }
            catch(err){ prompt('Copy this link:', window.location.href); }
          }
        });
      }

      // next image
      if(nextBtn && imgEl){ nextBtn.addEventListener('click', ()=>{ const i = images.findIndex(it=>it.src===imgEl.src); const n = images[(i+1) % images.length]; if(n){ imgEl.src = n.src; imgEl.alt = n.title; if(dateEl) dateEl.textContent = n.title; } }); }

      // repeat button
      if(repeatBtn && mantraAudio){ let repeat=false; repeatBtn.addEventListener('click', ()=>{ repeat=!repeat; mantraAudio.loop=repeat; repeatBtn.textContent = 'Repeat: ' + (repeat ? 'On' : 'Off'); }); }

      // thumbnails
      if(thumbGrid){ thumbGrid.innerHTML=''; images.forEach((it)=>{ const thumb=document.createElement('img'); thumb.src=it.src; thumb.alt=it.title; thumb.className='w-full h-20 object-cover rounded cursor-pointer'; const wrap=document.createElement('div'); wrap.className='rounded overflow-hidden'; wrap.appendChild(thumb); thumb.addEventListener('click', ()=>{ if(imgEl){ imgEl.src=it.src; imgEl.alt=it.title; } if(dateEl){ dateEl.textContent = it.title; } window.scrollTo({top:0,behavior:'smooth'}); }); thumbGrid.appendChild(wrap); }); }

      // subscribe form
      if(subsForm){ subsForm.addEventListener('submit',(e)=>{ e.preventDefault(); try{ const email = subsForm.email.value; alert('Thank you — ' + email + ' — we will send daily darshan updates soon (configure your mail service).'); subsForm.reset(); }catch(err){ console.warn(err); } }); }
    }

    // bootstrap
    document.addEventListener('DOMContentLoaded', async ()=>{ const content = await fetchContentJson(); initPageWithContent(content); });
  </script>

</body>
</html>
